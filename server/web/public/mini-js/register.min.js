function formatResponseMessage(s){return(s=s.substring(s.lastIndexOf("[")+1,s.lastIndexOf("]"))).replace(/\"/g,"")}function failureAlert(s){$("#alert").text(s).removeClass("is-success").addClass("is-danger").css({opacity:0,visibility:"visible"}).animate({opacity:1},400)}function successAlert(s){$("#alert").text(s).removeClass("is-danger").addClass("is-success").css({opacity:0,visibility:"visible"}).animate({opacity:1},400),window.setTimeout(function(){$("#alert").css({opacity:1,visibility:"visible"}).animate({opacity:0},400)},2500)}$("#register").on("submit",function(s){s.preventDefault();for(var e=$("#name"),a=$("#username"),i=$("#password"),r=!1,l=[e,$("#email"),a,i,$("#retypePw")],t=0;t<l.length;t++)l[t].removeClass("is-danger");for(t=0;t<l.length;t++){if(""===l[t][0].value){var n=l[t][0].id;failureAlert("retypePw"===n?"Please retype your password.":"Please fill out the "+n),l[t].addClass("is-danger");break}if(4===t){if(l[3][0].value!=l[4][0].value){failureAlert("Your passwords do not match"),l[3].addClass("is-danger"),l[4].addClass("is-danger");break}r=!0}}if(!0===r){var c={};$.each($("#register").serializeArray(),function(s,e){c[e.name]=e.value}),delete c.retypePw,c.application="Clotho Web",$.post("../../api/signup",c,function(){window.location.replace("/")}).fail(function(s){failureAlert(formatResponseMessage(s.responseJSON.message))})}});var emailFocus=!1,usernameFocus=!1;$("#email").focus(function(s){s.preventDefault(),emailFocus=!0}),$("#username").focus(function(s){s.preventDefault(),usernameFocus=!0}),$("#email").blur(function(s){!0===emailFocus&&(emailFocus=!1,$.post("/api/available",{email:$("#email")[0].value},function(s){var e=s.email.message,a="This email is available";e===a?($("#email").removeClass("is-danger").addClass("is-success"),$("#emailRightIcon").removeClass("fa-warning").addClass("fa-check"),$("#emailCheck").css("display",""),$("#emailStatus").text(a)):($("#email").removeClass("is-success").addClass("is-danger"),$("#emailRightIcon").removeClass("fa-check").addClass("fa-warning"),$("#emailCheck").css("display",""),$("#emailStatus").text(e))}).fail(function(s){var e=formatResponseMessage(s.responseJSON.message);$("#email").removeClass("is-success").addClass("is-danger"),$("#emailRightIcon").removeClass("fa-check").addClass("fa-warning"),$("#emailCheck").css("display",""),$("#emailStatus").text(e)}))}),$("#username").blur(function(){!0===usernameFocus&&(usernameFocus=!1,$.post("/api/available",{username:$("#username")[0].value},function(s){var e=s.username.message,a="This username is available";e===a?($("#username").removeClass("is-danger").addClass("is-success"),$("#usernameRightIcon").removeClass("fa-warning").addClass("fa-check"),$("#usernameCheck").css("display",""),$("#usernameStatus").text(a)):($("#username").removeClass("is-success").addClass("is-danger"),$("#usernameRightIcon").removeClass("fa-check").addClass("fa-warning"),$("#usernameCheck").css("display",""),$("#usernameStatus").text(e))}).fail(function(s){var e=formatResponseMessage(s.responseJSON.message);$("#username").removeClass("is-success").addClass("is-danger"),$("#usernameRightIcon").removeClass("fa-check").addClass("fa-warning"),$("#usernameCheck").css("display",""),$("#usernameStatus").text(e)}))}),$("#retypePw").keyup(function(s){s.preventDefault();var e=$("#password")[0].value,a=$("#retypePw")[0].value;""===e?($("#password").removeClass("is-success").addClass("is-danger"),$("#retypePwStatus").text("Please type in a password")):e===a?($("#password").removeClass("is-danger").addClass("is-success"),$("#retypePw").removeClass("is-danger").addClass("is-success"),$("#passwordRightIcon").removeClass("fa-warning").addClass("fa-check"),$("#retypePwRightIcon").removeClass("fa-warning").addClass("fa-check"),$("#passwordCheck").css("display",""),$("#retypePwCheck").css("display",""),$("#retypePwStatus").text("Passwords match!")):($("#password").removeClass("is-success").addClass("is-danger"),$("#retypePw").removeClass("is-success").addClass("is-danger"),$("#passwordRightIcon").removeClass("fa-check").addClass("fa-warning"),$("#retypePwRightIcon").removeClass("fa-check").addClass("fa-warning"),$("#passwordCheck").css("display",""),$("#retypePwCheck").css("display",""),$("#retypePwStatus").text("Passwords do not match"))});