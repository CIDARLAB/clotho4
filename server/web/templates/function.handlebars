{{> nav}}
<section class="hero">
  <div class="hero-heading">
    {{> alert}}
    <div class="container" style="padding: 10px">
      <h1 class="title">
        Custom Functions
      </h1>
      <a class="button is-primary" href="function/create">Create</a>
    </div>
  </div>
  <div class="hero-body">
    <div class="container">
      <div class="columns">
        {{#if query}}
          <div class="is-offset-1 column is-8">
            <input id="searchInput" class="input" type="text" value="{{query}}">
          </div>
          <div class="column is-2">
            <a id="search" class="button is-info">Search</a>
            <a id="clear" class="button">Clear</a>
          </div>
        {{else}}
          <div class="is-offset-1 column is-9">
            <input id="searchInput" class="input" type="text" placeholder="Find a function">
          </div>
          <div class="column is-1">
            <a id="search" class="button is-info">Search</a>
          </div>
        {{/if}}
      </div>
      <br>
      <div class="columns">
        <div class="column is-10 is-offset-1">
          {{#each functions}}
            <div class="box">
              <div class="level">
                <!-- Left side -->
                <div class="level-left">
                  <div class="level-item">
                    {{this.name}}
                  </div>
                  <div class="level-item">
                    {{this.description}}
                  </div>
                </div>
                <div class="level-right">
                  <div class="level-item">
                    {{#if this.working}}
                      <span class="tag is-success">Tested</span>
                    {{else}}
                      <span class="tag is-danger">Tests Failed</span>
                    {{/if}}
                  </div>
                  <div class="level-item">
                    <a id="view" class="button is-primary" href="/function/view/{{this._id}}">View</a>
                  </div>
                  <div class="level-item">
                    <a id="edit" class="button is-light" href="/function/edit/{{this._id}}">Edit</a>
                  </div>
                </div>
              </div>
            </div>
          {{/each}}
        </div>
      </div>
    </div>
  </div>
</section>
<script>
  $('#search').click( () => {
    var searchQuery = $('#searchInput').val();
    window.location.pathname = '/function/' + searchQuery;
  });

  $('#clear').click( () => {
    window.location.pathname = '/function';
  });

</script>
